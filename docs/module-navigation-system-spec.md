# 템플릿 기반 네비게이션 시스템 기획서

> 작성일: 2026-01-24  
> 버전: 2.0 (모듈 → 템플릿 용어 변경, 권한 체계 추가)

---

## 1. 개요

### 1.1 프로젝트 목표
현재 단순 flat 구조의 사이드바 네비게이션을 **계층형 카테고리 기반 템플릿 시스템**으로 확장하여, B2B SaaS 형태로 기업별 맞춤형 대시보드를 제공할 수 있는 구조 구축

### 1.2 비전
- 기업(Team)별로 필요한 템플릿만 선택하여 사용하는 **노션 스타일 템플릿 시스템**
- 대분류 카테고리 > 소분류 템플릿의 **2-depth 네비게이션** 구현
- 관리자가 템플릿을 쉽게 활성화/비활성화할 수 있는 **셀프서비스 설정**

### 1.3 핵심 변경사항 (v2.0)
| 항목 | v1.0 | v2.0 |
|------|------|------|
| 용어 | 모듈 | 템플릿 |
| 팀 생성 | 누구나 가능 | 시크릿 키 필요 |
| 역할 구분 | 없음 | ADMIN/MEMBER |
| 기본 템플릿 | 선택 | 매출관리 자동 활성화 |

---

## 2. 권한 체계

### 2.1 역할 정의

| 역할 | 부여 조건 | 권한 |
|------|----------|------|
| **ADMIN** | 팀 생성자 | 모든 설정 변경, 멤버 관리, 템플릿 설정 |
| **MEMBER** | 초대 코드로 합류 | 데이터 조회/입력, 개인 설정 |

### 2.2 팀 생성 제한

```
┌─────────────────────────────────────┐
│  새 팀 만들기                        │
├─────────────────────────────────────┤
│                                     │
│  팀 이름                             │
│  ┌─────────────────────────────┐   │
│  │ 우리 회사                     │   │
│  └─────────────────────────────┘   │
│                                     │
│  시크릿 키                           │
│  ┌─────────────────────────────┐   │
│  │ ••••••••••••                 │   │
│  └─────────────────────────────┘   │
│  발급받은 시크릿 키를 입력하세요      │
│                                     │
│  [팀 만들기]                         │
│                                     │
└─────────────────────────────────────┘
```

- 환경변수: `TEAM_CREATE_SECRET`
- 시크릿 키 없이는 팀 생성 불가
- 기존 팀 합류는 초대 코드로 가능

### 2.3 멤버 관리

| 동작 | ADMIN | MEMBER |
|------|-------|--------|
| 멤버 목록 조회 | O | O |
| 멤버 삭제 (MEMBER) | O | X |
| 멤버 삭제 (ADMIN) | X | X |
| 초대 코드 재생성 | O | O |

---

## 3. 템플릿 구조

### 3.1 카테고리 및 템플릿

```
📁 매출관리 (기본 활성화)
   ├── 📊 대시보드
   ├── 💰 거래
   └── 🏷️ 카테고리

📁 인사관리
   ├── 👥 직원 목록
   ├── 📅 근태 관리
   └── 💵 급여 관리

📁 재무관리
   ├── 📈 재무제표
   └── 🧾 세금 관리

📁 영업관리
   ├── 🤝 고객 관리
   └── 📋 영업 기회

📁 설정
   ├── ⚙️ 일반 설정
   └── 🧩 템플릿
```

### 3.2 기본 활성화 정책

- **매출관리**: 팀 생성 시 자동 활성화 (비활성화 불가)
- **설정**: 항상 표시
- **기타 카테고리**: 템플릿 설정에서 활성화 필요

---

## 4. 데이터 모델

### 4.1 User 모델 변경

```prisma
enum UserRole {
  ADMIN
  MEMBER
}

model User {
  // ... 기존 필드
  role   UserRole  @default(MEMBER)
}
```

### 4.2 Team 모델 변경

```prisma
model Team {
  // ... 기존 필드
  creatorId String @map("creator_id")
  creator   User   @relation("TeamCreator", fields: [creatorId], references: [id])
  
  enabledTemplates TeamTemplate[]
}
```

### 4.3 템플릿 시스템

```prisma
model TemplateCategory {
  id          String @id @default(cuid())
  key         String @unique
  name        String
  description String?
  icon        String
  order       Int    @default(0)
  templates   Template[]
}

model Template {
  id           String  @id @default(cuid())
  key          String  @unique
  name         String
  description  String?
  icon         String
  route        String
  previewImage String? @map("preview_image")
  order        Int     @default(0)
  isDefault    Boolean @default(false)
  
  categoryId    String           @map("category_id")
  category      TemplateCategory @relation(...)
  teamTemplates TeamTemplate[]
}

model TeamTemplate {
  id         String @id @default(cuid())
  teamId     String @map("team_id")
  templateId String @map("template_id")
  
  team     Team     @relation(...)
  template Template @relation(...)
  
  customOrder Int?    @map("custom_order")
  customName  String? @map("custom_name")
  
  @@unique([teamId, templateId])
}
```

---

## 5. UI/UX 설계

### 5.1 사이드바 (토글 구조)

```
┌──────────────────────────────┐
│  KPI Dashboard               │
├──────────────────────────────┤
│                              │
│  ▼ 매출관리                   │
│     ● 대시보드               │
│     ○ 거래                   │
│     ○ 카테고리               │
│                              │
│  ▼ 설정                       │
│     ○ 일반 설정              │
│     ○ 템플릿                 │
│                              │
└──────────────────────────────┘
```

### 5.2 템플릿 설정 페이지

```
┌──────────────────────────────────────────────────────┐
│  템플릿                                              │
│  필요한 기능을 선택하여 대시보드를 구성하세요          │
├──────────────────────────────────────────────────────┤
│                                                      │
│  📈 매출관리                                          │
│  수입과 지출을 체계적으로 관리하세요        3개 사용 중 │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐            │
│  │ 대시보드  │ │ 거래     │ │ 카테고리  │            │
│  │ 기본     │ │ 기본     │ │ 기본     │            │
│  │ 사용 중   │ │ 사용 중   │ │ 사용 중   │            │
│  └──────────┘ └──────────┘ └──────────┘            │
│                                                      │
│  👥 인사관리                                          │
│  팀원과 근태를 효율적으로 관리하세요                   │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐            │
│  │ 직원 목록 │ │ 근태 관리 │ │ 급여 관리 │            │
│  │ 클릭하여  │ │ 클릭하여  │ │ 클릭하여  │            │
│  │ 활성화   │ │ 활성화   │ │ 활성화   │            │
│  └──────────┘ └──────────┘ └──────────┘            │
│                                                      │
└──────────────────────────────────────────────────────┘
```

### 5.3 팀 멤버 관리 (설정 페이지)

```
┌──────────────────────────────────────────────────────┐
│  팀 멤버                                              │
│  3명의 멤버가 있습니다                                │
├──────────────────────────────────────────────────────┤
│                                                      │
│  ┌────────────────────────────────────────────────┐ │
│  │ 👤 김철수                          [관리자]    │ │
│  │    kim@example.com                             │ │
│  └────────────────────────────────────────────────┘ │
│                                                      │
│  ┌────────────────────────────────────────────────┐ │
│  │ 👤 이영희                                  🗑️ │ │
│  │    lee@example.com                             │ │
│  └────────────────────────────────────────────────┘ │
│                                                      │
│  ┌────────────────────────────────────────────────┐ │
│  │ 👤 박민수                                  🗑️ │ │
│  │    park@example.com                            │ │
│  └────────────────────────────────────────────────┘ │
│                                                      │
└──────────────────────────────────────────────────────┘

※ 관리자는 멤버만 삭제 가능, 관리자끼리는 삭제 불가
```

---

## 6. 구현 현황

### 6.1 완료된 항목 (v2.0)

- [x] User 모델에 role 필드 추가 (ADMIN/MEMBER)
- [x] Team 모델에 creatorId 추가
- [x] 팀 생성 시 시크릿 키 검증
- [x] 팀 생성자 ADMIN 자동 부여
- [x] 합류자 MEMBER 자동 부여
- [x] 멤버 삭제 기능 (관리자만, MEMBER만 삭제 가능)
- [x] 템플릿 시스템 스키마 (TemplateCategory, Template, TeamTemplate)
- [x] 사이드바 카테고리 토글 구조
- [x] 모바일 네비게이션 동기화
- [x] 템플릿 설정 페이지 UI

### 6.2 다음 단계

- [ ] Prisma migrate 실행
- [ ] 시드 데이터 작성
- [ ] 템플릿 활성화/비활성화 API
- [ ] 실제 템플릿 페이지 구현 (인사관리, 재무관리 등)

---

## 7. 환경 설정

### 7.1 필수 환경변수

```env
# 팀 생성 시크릿 키 (관리자가 발급)
TEAM_CREATE_SECRET=your-secret-key-here
```

### 7.2 시크릿 키 관리

- 외부 공개 금지
- 정기적 갱신 권장
- 팀 생성 요청 시 개별 발급

---

## 8. 파일 구조

```
src/
├── config/
│   └── navigation.ts           # 네비게이션 설정
├── components/layout/
│   ├── sidebar.tsx             # 카테고리 토글 사이드바
│   └── mobile-nav.tsx          # 모바일 네비게이션
├── app/(dashboard)/
│   ├── settings/
│   │   ├── page.tsx            # 일반 설정
│   │   ├── remove-member-button.tsx
│   │   └── templates/
│   │       └── page.tsx        # 템플릿 설정
│   └── [각 템플릿 라우트]/
├── actions/
│   └── teams.ts                # 팀 관련 서버 액션
└── types/
    └── index.ts                # UserRole 타입 정의

docs/
├── module-navigation-system-spec.md  # 이 문서
└── template-creation-guide.md        # 템플릿 작성 가이드
```

---

## 9. 요약

| 구분 | AS-IS | TO-BE |
|------|-------|-------|
| 네비게이션 | Flat 4개 메뉴 | 2-depth 카테고리 + 토글 |
| 팀 생성 | 누구나 가능 | 시크릿 키 필요 |
| 역할 | 없음 | ADMIN / MEMBER |
| 템플릿 | 고정 | 기업별 선택 가능 |
| 기본 제공 | 전체 | 매출관리만 |

**핵심 가치**: 기업별 맞춤형 대시보드 → B2B SaaS 경쟁력 확보
